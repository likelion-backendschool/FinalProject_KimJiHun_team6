## Title: [2Week] 김지훈

### 미션 요구사항 분석 & 체크리스트

- [x] 주문
- [x] 결제
- [x] 장바구니
- [x] PG 연동
- [ ] 환불

### 2주차 미션 요약

**[ 장바구니 ]**
- 상품이 곧 도서이다.
- 도서를 장바구니에 담을 수 있다.
- 장바구니에서 도서를 제거할 수 있다.
- 장바구니에 담긴 도서들을 가지고 주문을 할 수 있다.

**[ 주문 ]**
- 주문 상세페이지에서 주문 준비상태다.
- 장바구니에서 전체 주문하기 선택하여 주문한다.
- 주문하기를 누르면 장바구니 안의 상품들은 삭제되고 주문 상세페이지로 이동한다.

**[ 결제 ]**
- 회원이 결제를 할 때 기존에 소유하고 있는 캐시를 사용할 수 있다.
- 본 쇼핑몰에서의 모든 현금 흐름은 CashLog 에 기록된다.
- CashLog 테이블은 사이버 머니에 대한 기록 테이블이다.
- 결제를 하게되면 CashLog 테이블에 돈이 충전된 후 바로 사용된다.
- 토스 페이먼츠를 이용해서 카드 결제를 구현한다.
- 결제가 완료되면 MyBook 테이블에 책이 구매된 책이 추가된다.

### 2주차 회고

**[ 변경된 엔드포인트 ]**
1. **품목삭제**
기존의 장바구니 엔드포인트는 품목 하나하나를 삭제하는 요구사항이였으나 체크박스로 선택 삭제가 낫다고 판단해 변경
    ```
    POST /cart/remove/{productId} -> Post /cart/removeItems
    ```
2. **결제처리**
결제처리 관련은 전액을 예치금(CashLog)으로 결제하는 포인트와 일부를 예치금으로 결제하고 나머지를 카드결제하는 포인트를 나누어 세분화
    ```
    POST /order/{id}/pay
    -> POST /order/{id}/payByRestCashOnly
    -> POST /order/{id}/success
    -> POST /order/{id}/fail
    ```
3. **주문리스트 및 환불처리**
주문상세와 주문리스트의 차이점을 이해하지 못해 주문상세만 구현
환불처리는 미구현

**[ 장바구니 추가 ]**  
장바구니 버튼을 누르면 `상품이 추가되었습니다`라는 메세지와 함께 장바구니에 하나씩 추가가 됩니다.
<img width="694" alt="스크린샷 2022-10-26 오후 2 00 24" src="https://user-images.githubusercontent.com/55697125/197938934-cf15b0cb-34ec-4aee-9e99-73d21b0bf202.png">

**🐛오류회고**
> **장바구니 버튼을 누르면 계속 같은 아이디값으로 장바구니에 추가되는 오류**  

기존 a태그로 구성되어 있던 장바구니 버튼을 `onClick` 이란 메서드를 활용해 form에 접근해 Post 요청을 보냈는데 계속 같은 상품아이디를 url로 보내는 오류가 생겼다.

> **해결방안**

a태그를 버튼 태그로 바꿔서 해결했다.
```html
<form method="post" th:action="@{|/cart/add/${product.id}|}">
    <button th:if="${@rq.isLogined()}" class="btn gap-2">
        <svg xmlns="http://www.w3.org/2000/sclass="h-4 w-4" fill="none" viewBox="0 0 24 stroke="currentColor"><pstroke-linecap="round" stroke-linejoin="roustroke-width="2" d="M4.318 6.318a4.5 4.5 0 6.364L12 20.364l7.682-7.682a4.5 4.5 0 0364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 0364 0z" /></svg>
        장바구니
     </button>
</form>
```

### Refactoring
**[1차 리팩토링]**
- [ ] 환불

**[2차 리팩토링]**
- 2차 리팩토링은 피어리뷰를 통해 전달받은 다양한 의견과 피드백을 조율하여 진행합니다.
